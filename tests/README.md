# Smoke Tests для Atlassian Marketplace Scraper

Smoke tests (дымовые тесты) - это базовые тесты, которые проверяют, что основные функции системы работают и система не сломана.

## Что проверяют smoke tests

### 1. **MetadataStore** (`TestMetadataStore`)
- Инициализация хранилища метаданных
- Получение количества приложений
- Получение списка приложений
- Поиск приложения по ключу

### 2. **DownloadManager** (`TestDownloadManager`)
- Инициализация менеджера загрузок
- Получение статистики хранилища
- Получение детальной статистики хранилища

### 3. **Search Functionality** (`TestSearchFunctionality`)
- Импорт и инициализация EnhancedSearch
- Базовый функционал EnhancedSearch
- Импорт и инициализация WhooshSearchIndex
- Проверка необходимости перестроения индекса

### 4. **File System** (`TestFileSystem`)
- Существование директорий для описаний
- Существование директорий для метаданных
- Существование директорий для бинарных файлов

### 5. **Settings** (`TestSettings`)
- Загрузка настроек
- Корректность путей в настройках

### 6. **Enhanced Search Detailed** (`TestSearchEnhancedDetailed`)
- Поиск по именам приложений
- Поиск по именам вендоров
- Обработка пустых запросов
- Структура результатов поиска

### 7. **Storage Stats** (`TestStorageStats`)
- Структура базовой статистики хранилища
- Структура детальной статистики хранилища

## Запуск тестов

### Быстрый запуск

```bash
python run_smoke_tests.py
```

### С подробным выводом

```bash
python run_smoke_tests.py --verbose
```

### Только быстрые тесты

```bash
python run_smoke_tests.py --quick
```

### Через unittest напрямую

```bash
python -m unittest tests.test_smoke
```

### Через pytest (если установлен)

```bash
pytest tests/test_smoke.py -v
```

## Ожидаемый результат

При успешном выполнении всех тестов вы увидите:

```
======================================================================
SMOKE TESTS - Atlassian Marketplace Scraper
======================================================================

Tests run: 25
Failures: 0
Errors: 0
Skipped: 0
======================================================================

✓ All smoke tests passed!
```

## Интерпретация результатов

- **Tests run**: Количество выполненных тестов
- **Failures**: Количество провалившихся тестов (проверка не прошла)
- **Errors**: Количество тестов с ошибками (исключения)
- **Skipped**: Количество пропущенных тестов (например, если Whoosh не установлен)

## Что делать, если тесты провалились

1. **Проверьте логи**: Ошибки содержат traceback с подробной информацией
2. **Проверьте зависимости**: Убедитесь, что все пакеты установлены (`pip install -r requirements.txt`)
3. **Проверьте данные**: Некоторые тесты требуют наличия данных в базе (приложения, описания)
4. **Проверьте пути**: Убедитесь, что пути в настройках корректны

## Добавление новых тестов

Чтобы добавить новый smoke test:

1. Откройте `tests/test_smoke.py`
2. Добавьте новый класс, наследующийся от `unittest.TestCase`
3. Добавьте методы, начинающиеся с `test_`
4. Добавьте класс в список `test_classes` в функции `run_smoke_tests()`

Пример:

```python
class TestNewFeature(unittest.TestCase):
    """Test new feature."""
    
    def test_new_feature_basic(self):
        """Test basic new feature functionality."""
        # Your test code here
        self.assertTrue(True)
```

## Примечания

- Smoke tests должны выполняться быстро (несколько секунд)
- Тесты не должны изменять данные (read-only)
- Тесты должны быть независимыми друг от друга
- Некоторые тесты могут быть пропущены (skip), если зависимости недоступны

